name = "proposal"
resources = "gpus"

[matrix]
dataset = ["MELD--E", "IEMOCAP--E"]
seed = ["114"]

[tasks.unimodal]
command = "uv run emotion-recognize train"
args = [
    "configs/dataset/{dataset}.toml",
    "configs/encoders/T.toml",
    "configs/losses/classification/focal.toml",
    "--seed {seed}",
]

[tasks.losses]
command = "uv run emotion-recognize train"
args = [
    "configs/dataset/{dataset}.toml",
    "configs/encoders/T+A+V.toml",
    "configs/fusion/disentanglement.toml",
    "configs/losses/classification/focal.toml",
    "{extra}",
    "--seed {seed}",
]
deps = ["unimodal"]
[tasks.losses.matrix]
extra = [
    "configs/losses/frl.toml",
    "--teacher-checkpoint checkpoints/training/{dataset}/trainable--2--focal/1xE--T/ce200638--{seed}",
]

[tasks.model]
command = "uv run emotion-recognize train"
args = [
    "configs/dataset/{dataset}.toml",
    "configs/encoders/T+A+V.toml",
    "configs/fusion/{fusion}.toml",
    "configs/losses/classification/focal.toml",
    "configs/losses/frl.toml",
    "--teacher-checkpoint checkpoints/training/{dataset}/trainable--2--focal/1xE--T/ce200638--{seed}",
    "--seed {seed}",
]
deps = ["unimodal"]
[tasks.model.matrix]
fusion = ["vallina", "shared", "private"]

[tasks.modality]
command = "uv run emotion-recognize train"
args = [
    "configs/dataset/{dataset}.toml",
    "configs/encoders/{encoder}.toml",
    "configs/fusion/disentanglement.toml",
    "configs/losses/classification/focal.toml",
    "configs/losses/frl.toml",
    "--teacher-checkpoint checkpoints/training/{dataset}/trainable--2--focal/1xE--T/ce200638--{seed}",
    "--seed {seed}",
]
deps = ["unimodal"]
[tasks.modality.matrix]
encoder = [
    "T+A",
    "T+V",
]
